<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>B√°ch Khoa V·ªÅ C√¢y</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f5fff4;
      padding: 20px;
    }
    h1 {
      color: #2e7d32;
      text-align: center;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      background: #fff;
      box-shadow: 0 0 10px #ccc;
    }
    th, td {
      padding: 12px;
      border: 1px solid #ddd;
      text-align: left;
    }
    th {
      background-color: #81c784;
      color: white;
    }
    tr:hover {
      background-color: #f1f8e9;
    }
    .btn {
      padding: 8px 14px;
      margin: 5px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    .btn-add { background-color: #4caf50; color: white; }
    .btn-delete { background-color: #e53935; color: white; }
    .btn-edit { background-color: #039be5; color: white; }
    .btn-back { background-color: #8d6e63; color: white; float: right; }
  </style>
</head>
<body>

<h1>B√°ch Khoa V·ªÅ C√¢y C·ªï Th·ª•</h1>

<table id="cayTable">
  <thead>
    <tr>
      <th>T√™n C√¢y</th>
      <th>ƒê·∫∑c ƒêi·ªÉm</th>
      <th>H√†nh ƒê·ªông</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>

<br>
<button class="btn btn-add" onclick="addRow()">‚ûï Th√™m C√¢y</button>
<button class="btn btn-back" onclick="window.location.href='/'">üè† Trang Ch·ªß</button>

<script>
  let data = [];

  function fetchData() {
    fetch('/get_cay')
      .then(res => res.json())
      .then(json => {
        data = json;
        renderTable();
      });
  }

  function renderTable() {
    const tbody = document.querySelector("#cayTable tbody");
    tbody.innerHTML = "";
    data.forEach((item, index) => {
      const row = `
        <tr>
          <td>${item.name}</td>
          <td>${item.detail}</td>
          <td>
            <button class="btn btn-edit" onclick="editRow(${index})">S·ª≠a</button>
            <button class="btn btn-delete" onclick="deleteRow(${index})">Xo√°</button>
          </td>
        </tr>
      `;
      tbody.innerHTML += row;
    });
  }

  function addRow() {
    const name = prompt("Nh·∫≠p t√™n c√¢y:");
    if (!name) return;
    const detail = prompt("Nh·∫≠p ƒë·∫∑c ƒëi·ªÉm:");
    if (!detail) return;
    fetch('/add_cay', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({name, detail})
    }).then(() => fetchData());
  }

  function editRow(index) {
    const newName = prompt("S·ª≠a t√™n c√¢y:", data[index].name);
    if (!newName) return;
    const newDetail = prompt("S·ª≠a ƒë·∫∑c ƒëi·ªÉm:", data[index].detail);
    if (!newDetail) return;
    fetch('/edit_cay', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({index, name: newName, detail: newDetail})
    }).then(() => fetchData());
  }

  function deleteRow(index) {
    if (!confirm(`B·∫°n c√≥ ch·∫Øc mu·ªën xo√° c√¢y "${data[index].name}"?`)) return;
    fetch('/delete_cay', {
      method: 'POST',
      headers: {'Content-Type': 'application/json'},
      body: JSON.stringify({index})
    }).then(() => fetchData());
  }

  fetchData();
</script>

</body>
</html>